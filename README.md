# netVax

Simulation study to identify indirect protection of vaccination with a transmissible vaccine.
## shinyTrans
- app.R: code for Shiny app to get required sample sizes of trials comparing transmissible vaccines to traditional vaccines. The app is available at https://j-k-s.shinyapps.io/shinyTrans/
## code/twostage/
### analysis/revision:
- Scripts used for analysis of simulation data comparing transmissible vaccine to traditional vaccine. These file obtains the required sample sizes using the simulation bank generated by the files in code/twostage/sim. Each file is named as (Poisson contact structure or "" for overdispersed contact structure)\_antici\_(Estimand of interest).R.
- Within each file the following parameters can be set by the user: (1) N\_sims: number of cluster simulations in the simulation bank (see sim/revision) (2) N\_sample: number of animals to sample from each cluster (3) N\_trials: number of trial simulations to conduct (4) n\_perm: number of permutations for the null distribution of the hypothesis test when the number of clusters of the simulated trial is greater than 12 (5) cutoff: day of follow-up after start of epidemic (6) alpha: significance level of hypothesis test (7) num\_bootstrap\_sample: number of resamples to make up bootstrap (8) assignment_mechanisms: assignment mechanisms of each arm. Set as (percentage vaccinated [0 or 0.05])\_(vaccine type [trad. or trans.]) (9) N\_assignment_mechanism\_sets: number of clusters for each arm of the trial (10) R0\_vax: R0 of the vaccine if transmissible (11) vaxEff: vaccine efficacy (12) threshold_inclusion: if the number of sampled infections is below this number, exclude from analysis
- There is one main function of each file, "run_trial" which will run the trial simulation. N\_sample are sampled from each cluster, and the estimate is calculated based on the sample for the estimand of interest using the function "calc_est". A permutation test is then conducted, either an exact test when 12 or less clusters are recruited for the trial, or a permutation test with 1000 permutations otherwise. A bootstrap sample is then calculated for the estimate.
- The function "run_trial" is run in parallel across the number of cores - 1 that the user supplies. 
### figs: 
- These are scripts used to create Figures 2, 3, and S3
### prelim: 
- scripts used to create preliminary data, i.e., transmission rate that corresponds to the input R0 for each type of network structure. getPrelim_SEIR_Pois.py obtains these parameters when the contact structure is Poisson distributed while getPrelim_SEIR.py obtains these parameters when the contact structure is overdispersed (k=1).
### sim/revision: 
- Scripts used to create simulation bank for analysis when comparing transmissible vaccine to traditional vaccine. sim_twostage_SEIR_antici_revision.py creates simulations for overdispersed contact structures where trials are anticipatory, sim_twostage_SEIR_Pois_antici_revision.py creates simulations for Poisson contact structures where trials are anticipatory, and sim_twostage_SEIR_Pois_revision.py creates simulations for Poisson contact structures where trials are reactionary.
- Users can specify the following epidemiological parameters for the set of simulations they wish to create: number of animals per cluster, R0 of the wildtype pathogen, R0 of the vaccine, vaccine efficacy, percentage initially vaccinated, whether the vaccine is traditional or transmissible, and the number of simulations users wish to create.
## sim/novax: 
- Scripts used for analysis of simulation data comparing transmissible vaccine to no vaccine. sim_twostage_SEIR.py create simulations for overdispersed contact structures where trials are reactionary, sim_twostage_SEIR_Pois.py creates simulations for Poisson contact structures where trials are reactionary, sim_twostage_SEIR_antici.py creates simulations for overdispersed contact structures where trials are anticipatory, and sim_twostage_SEIR_Pois_antici.py creates simulations for Poisson contact structures where trials are anticipatory.
## code_output/
### figs:
- Figures 2, 3, and S3
### prelim: 
- Preliminary data necessary for simulations, i.e., transmission rate that corresponds to the input R0 for each type of network structure. See above section "code/twostage/prelim" for more details.
### twostage/rData: 
- All output files by scripts in code/twostage/analysis. See above section "code/twostage/analysis/revision" for more details.
### twostage/sims: 
- All simulations output by scripts in "code/twostage/sim"

These programs are a work in progress, as we work to improve usability, error-catching, and speed of analysis. If you find errors, please contact Justin Sheen at jsheen (at) princeton (dot) edu.

Last Update: March 16, 2024
